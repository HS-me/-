##vCenter 연결
$vCenter = "ckh-vcsa-01.alt.coin"
Write-Host "vCenter 접속 $vCenter" -ForegroundColor Green   
$User = "administrator@vsphere.local"
$Password = "VMware1!"
#$SecurePassword = Read-host  "vCenter Password를 적어주세요" -AsSecureString
#$Password = [Runtime.InteropServices.Marshal]::PtrToStringAuto([Runtime.InteropServices.Marshal]::SecureStringToBSTR($SecurePassword))
Connect-VIServer -Server $vCenter -User $User -Password $Password

##클러스터 이름 지정.*클러스터 이름* 안은 지정해야함.
$Cluster = Get-Cluster -name "vSANCluster" | Sort-Object "name"
 
#검증할 패스워드 입력
$user = "root"
$CheckPassword = Read-host   "검증할 패스워드를 입력해주세요"

    foreach ($clusterOne in $Cluster) {
        
      ##클러스터에서 호스트들 추출.
      $hosts = Get-Cluster -Name $clusterOne | Get-VMHost | Sort-Object "name"
       
  foreach ($hostOne in $hosts) {   
         Write-Host "작업중인 Host: $hostOne" -ForegroundColor Green              

    try {
      Connect-VIServer -Server $hostOne -User $user -Password $CheckPassword -ErrorAction Stop | Out-Null
       "Logon Success on $($hostOne.Name)"
    }
    catch {
      "Logon Failed on $($hostOne.Name)" 
    }
  } 
             
}
    


    