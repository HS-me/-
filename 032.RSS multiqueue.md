Multiqueue는 네트워크 인터페이스 카드(Network Interface Card, NIC)에서 제공되는 기능 중 하나입니다. NIC의 멀티큐(Multiqueue) 기능은 데이터 패킷을 여러 개의 독립적인 큐(Queue)로 분할하여 처리하는 기술입니다.

일반적으로 NIC는 패킷을 하나의 큐에 순차적으로 수신하고 처리합니다. 그러나 많은 네트워크 트래픽이 발생하는 고속 네트워크 환경에서는 단일 큐로 처리하면 병목 현상이 발생할 수 있습니다. 이를 해결하기 위해 멀티큐 기능을 사용하여 NIC는 여러 개의 수신 큐를 사용하여 패킷을 동시에 처리할 수 있습니다.

멀티큐를 사용하면 여러 개의 CPU 코어 또는 스레드를 사용하여 병렬로 패킷 처리가 가능해지므로, 높은 처리량과 더 나은 성능을 제공할 수 있습니다. 또한, 멀티큐는 네트워크 트래픽을 분산시켜 시스템의 부하를 분산시키는 효과도 있습니다.

멀티큐는 특히 서버 환경에서 네트워크 성능을 향상시키는 데 사용되며, 가상화 환경에서 가상머신(VM) 또는 컨테이너를 개별적으로 처리하기 위한 가상화 NIC(Virtual NIC)에도 적용될 수 있습니다.

다양한 운영 체제와 네트워크 카드에서 멀티큐 기능을 지원하고 있으며, 네트워크 스택, 드라이버, 애플리케이션 등에서 이를 활용하여 성능을 최적화할 수 있습니다.


1. VM단에서 vmx는 설정해놓고 진행.
2. 셀키의 블로그 - 리눅스에서 rx,tx 체크하는 방법
3. iperf 테스트 -> 운영팀이 테스트를 rss 켠상태에서 iperf, 끈 상태에서 (parameter는 동일한 상태에서) iperf 해봐야하는게 기본 방향이 맞음. 해당 테스트를 진행하면서 cpu사용량이 실제로 증가하는가 등의 성능 변화를 확인하는 것.
   -> 확인은 vCenter의 가상화단에서 체크 
4. MS의 문제제기사항은 제대로 구성이 안된것같다.
   -> 특정 nic로? queue가 몰린다.
5. vmk의 입장은 우리가 RSS를 설정하고 나서, 4개의 길에서 queue가 발생하고있다는 것을 먼저 보여주자. -> iperf로 진행을 하되 정확한 파라미터를 지정해서 실험결과를 보여주자는 것. 

 6. 패러미터 -> MTU 사이즈..
 7. 윈도우에서 RSS테스트를 했을 때 한곳으로 몰리고있다고하는데, ESXi에선 잘 된다고한다면 MS가 이걸 확인해줘! 라고 할수도 있음.(자료없음)
 8. MS에 RSS 구성 후 윈도우에서 패킷캡처하는 테스트 방법을 요청하는것도 다른 방안
 



get-netadapterrss -> rss설정되어있는지 확인하는 명령어
ESXi에서 RSS는 기본 default
윈도우에선 ncpa.cpl의 네트워크 어댑터 고급설정에서 기본으로 enable
RSS Base processor number -> 
소켓 x 프로세서 = 코어

하드웨어에서는 기본 하드웨어단의 바이오스에서 설정해줘야하고


[멀티 큐(Multi-Queue) 사용 시 고려 사항 : 네이버 블로그 (naver.com)](https://m.blog.naver.com/serkis_/221306589125)
http://kwholee.blogspot.com/2021/01/esxi-host-to-hostvm-bandwidth.html
https://luckygg.tistory.com/380




RSS(Receive Side Scaling)는 네트워크 인터페이스에서 수신하는 패킷을 여러 CPU 코어 또는 스레드에 분산시켜 병렬로 처리하는 기술입니다. RSS는 멀티큐(Multiqueue)와 밀접한 관련이 있습니다.

멀티큐는 네트워크 인터페이스에서 제공되는 기능으로, 패킷을 여러 개의 독립적인 큐로 분할하여 처리하는 것을 의미합니다. RSS는 멀티큐를 활용하여 수신 패킷을 여러 큐로 분산시키는 방식으로 동작합니다.

일반적으로, 네트워크 인터페이스에서 패킷을 수신하면 패킷은 하나의 큐에 도착하고, 해당 큐를 처리하는 CPU 코어 또는 스레드에서 처리됩니다. 그러나 네트워크 트래픽이 많아질 경우, 수신 패킷의 처리가 단일 CPU 코어 또는 스레드에 집중되어 병목 현상이 발생할 수 있습니다.

RSS는 이러한 문제를 해결하기 위해 패킷의 송신 IP 주소나 포트 번호 등을 기반으로 패킷을 여러 수신 큐로 분산시킵니다. 이렇게 하면 각 큐는 독립적으로 패킷을 처리할 수 있으며, 여러 CPU 코어 또는 스레드에서 병렬로 패킷을 처리할 수 있습니다.

따라서, RSS는 멀티큐를 기반으로 수신 패킷의 분산 처리를 가능하게 하여 네트워크 성능을 향상시키는 기술입니다. RSS를 사용하면 고속 네트워크에서도 다중 CPU 코어 또는 스레드를 활용하여 패킷을 병렬로 처리할 수 있어, 처리량을 늘리고 성능을 향상시킬 수 있습니다.