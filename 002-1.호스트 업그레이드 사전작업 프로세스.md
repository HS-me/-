[호스트 업그레이드/업데이트 사전작업]

1. vcenter 버전 확인(센터가 호스트보다 버전이 높아야 함)

2. 센터VM이 어떤 호스트에 위치하는지 확인

3. 호스트 버전 확인 - 하이퍼바이저랑 모델명, cpu 유형 확인

4. 하드웨어 호환성 가이드가서 해당 버전과 하드웨어의 호환성 여부 확인

5. 바이오스 버전 확인( vsish get /hardware/bios/biosinfo )

7. 호스트 ssh 접근 가능 여부 확인
안되면 방화벽 열어달라고하거나 접근 가능한 VM 할당 신청

8. 라이센스 확인
업그레이드 이전 사용중인 라이센스가 업그레이드 후에도 사용 가능한지 확인
라이센스는 일종의 업그레이드가 가능. 
kibok.song@skhynix.com
kibok.song

현재 사용중인 라이센스가 검색이 안되면 라이센스 트래커에서 확인
1.customer connect - account - manage license
2.account 아래 라이센스 키 트래커 -> 키 히스토리

9. CLI로 NIC RAID FC firmware/driver 확인

nic
esxcli network nic list
리스크 확인 후 어떤 종류 nic 사용하고있는지 확인
해당 vmnic에서 어떤 nic를 쓰는지 드라이버는 뭔지 링크스테이트가 어떤지 조사

esxcli network nic get -n vmnic*으로 펌웨어 드라이버 확인

esxcli storage san fc/sas/fcoe list
-> 온라인 된것부터 확인하고 온라인 되어있는 것들의 펌웨어 하드버전이 다를경우 하드웨어 엔지니어에게 확인

10. 하드웨어 호환성 확인
vmkchdev -l l grep vmnic, vmhba

드라이버와 펌웨어는 같은 줄에 있는 녀석들끼리 쓰는게 제일 안정적이고 안될 경우 드라이버는 펌웨어보다 낮거나 같게 사용한다.

만약 드라이버나 펌웨어 버전이 호환성 검사 페이지에서 나오지 않을 경우, 하드웨어쪽이 직접 드라이버나 펌웨어를 찾고 그것이 업그레이드 할 esxi 버전과 호환 되는지 고객한테 그쪽이 알려줘야 함.

** 설치 후 확인해야하는 것**
-> 네트워크 설정 상태가 기존 호스트와 일치하는지, 이중화로 잘 붙어있는지 확인(가상스위치 설정, vmk 서비스 등)
(네트워킹 영역 모두 직접 edit 클릭해서 확인)

-> 라이센스 확인
-> NTP설정 직접 눌러서 IP가 들어가있는지 확인
-> 호스트 - 모니터 - 이벤트 들어가서 이벤트 뜬게 있는지 확인


[전체 사전작업 진행프로세스]

업그레이드 예정일 잡힘

업그레이드 할 하드웨어의 vid sid vsid ssid에 맞춰서 일단 최신의 펌웨어와 드라이버 버전으로 매니저에게 보고

해당 보고는 매니저가 하드웨어 담당자에게 전달

하드웨어 담당자는 다시 매니저한테 하드웨어에 맞는 펌웨어와 디바이스 정보를 다시 매저에게 보내고 해당 정보는 다시 나에게 온다.

이후 받은 정보 기준으로 다시 드라이버와 펌웨어 버전을 조사한다

해당 펌웨어 버전 확인. 기존에 보낸 드라이버버전과 다르다면 다시 처음 보냈던 보고를 수정해주는데 이때 패치 vib 파일 내에 해당 펌웨어와 드라이버가 있는지 확인