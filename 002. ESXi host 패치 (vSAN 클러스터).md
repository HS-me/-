# 사전 점검 사항
1. 패치 목표 버전과 현재 vCenter Server와 호환성 체크
- https://interopmatrix.vmware.com/Interoperability

2. 패치 파일과 하드웨어 FW와 호환성 조사 후 필요 드라이버 조사
3. VM 마이그레이션
4. 유지보수 모드 전환
5. 패치 파일, 필요 드라이버 업로드

**vSAN 클러스터 일때 추가 작업(나중에 추가 필요)
1. Skyline heath check (모니터 -> vSAN)
2. 유지보수 하기전 데이터 마이그레이션 사전 검사(유지보수모드 진입시 vSAN데이터 마이그레이션이 일어난다)
3. 객체 다시동기화
4. IO값 체크

# 작업 프로시저
1. 대상 IP, FQDN 확인후 SSH접속
2. 프로파일 Name 확인 
  - esxcli software sources profile list -d [.zip 절대경로]
3. 설치할 대상 프로파일 확인 후 드라이런
  - esxcli software profile update -d [.zip 절대경로] -p [프로파일 Name] --dry-run
  - bootbank_esx~base 버전 및 빌드번호 꼭 확인하기!
4. 설치 후 설치된 VIB 및 드라이버 확인하여 FW에 맞는 호환성 체크
 - esxcli software profile update -d [.zip 절대경로] -p [프로파일 Name]
5. 추가적으로 업데이트나 다운그레이드 할 드라이버들을 업데이트 해준다.
 - esxcli software vib update -d [.zip 절대경로] --dry-run
 - esxcli software vib update -d [.zip 절대경로]
 - skipped가 나오면 다운그레이드 임으로
 - esxcli software vib install -d [.zip 절대경로] --dry-run
 - esxcli software vib install -d [.zip 절대경로] --dry-run
6. reboot 진행 후 모니터링
7. 이상 없다면 유지 보수 모드 해제

# 작업 시 발생  할 수 있는 이슈 및 특이사항
2023.05.18
<유지보수모드 진입 전 VM migration precheck 에서 fail>
이슈 알람
-작업이 개체에서 지원되지 않습니다 다중설정 CBT 지원
원인
- VM 설정에 CBT설정이 걸려있다.
-> CBT설정이 걸려있으면 vMotion 불가
-> CBT설정 off (방법 2가지)
  1. Power shell server를 사용하여 off
  2. VM 종료후 CBT 설정 off


# 작업 시 주의 사항